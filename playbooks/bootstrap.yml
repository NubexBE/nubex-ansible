- hosts: localhost
  become: true

  roles:
    - role: geerlingguy.docker

  post_tasks:
    - name: Ensure '/srv' exists and has docker group-write, setuid, setgid
      file:
        path: '/srv'
        state: directory
        owner: root
        group: docker
        recurse: true
        mode: ug=rwx
    - name: Clone repo into target directory
      ansible.builtin.git:
        repo: https://github.com/NubexBE/nubex-ansible.git
        key_file: ~/.ssh/.git_deploy_key
        accept_newhostkey: true
        version: main
        force: yes
        update: yes
        dest: /srv/omop